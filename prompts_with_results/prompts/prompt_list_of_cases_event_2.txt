Ты — инженер по тестированию пользовательских интерфейсов.

Работа ведётся в интерфейсе Marketer, где пользовательские события используются как триггеры для запуска рассылок.

---

Цель

Сформулируй список ключевых аспектов, которые необходимо покрыть в тестах при редактировании пользовательского события.

Не пиши конкретные тесты.  
Не придумывай поведение, которого нет в документации.

---

Что требуется

Для каждого аспекта укажи:

- Название — короткое и точное;
- Что проверяется — 1–2 предложения, описывающие поведение;
- Почему важно — ограничения, бизнес-логика или особенности интерфейса.

Формат для каждого пункта:

1. <Название аспекта>  
   Что проверяется: …  
   Почему важно: …

---

Требования

- Выведи от 10 до 15 аспектов.
- Фокусируйся только на поведении интерфейса Marketer, включая:
  - отображение данных;
  - реакцию на действия пользователя (клики, ввод, переключения);
  - валидацию данных;
  - поведение при ошибках;
  - запрет недопустимых операций;
  - взаимодействие с backend при редактировании.
- Не включай аспекты, связанные с:
  - визуальной стилизацией;
  - кроссбраузерностью;
  - адаптивностью;
  - мультиязычностью.

---

Область покрытия

Сконцентрируйся на следующих действиях:

- изменение названия события;
- изменение и валидация идентификатора события;
- добавление/удаление аргументов события;
- изменение имён и идентификаторов аргументов;
- валидация идентификаторов и типов аргументов;
- ограничения, если событие связано с рассылками;
- реакция интерфейса на попытки нарушить ограничения;
- взаимодействие с backend при применении изменений.

---

Документация

Используй только поведение, описанное в следующих фрагментах:  

События могут являться триггером к началу рассылки для клиента. Это удобно для решения некоторых маркетинговых задач. Например, можно создать событие «Клиент воспользовался услугой» и генерировать его при оплате клиентом услуги. Получив информацию о событии, бот может запустить одну или несколько рассылок этому клиенту: контроль качества через несколько дней, повторное предложение услуги со скидкой через месяц и т. д.
События делятся на два типа:
1. Системные:
• Добавление нового клиента;
• Подтверждение номера телефона.
2. Пользовательские.

Пользовательские события
Пользовательские события могут генерироваться из другой рассылки или с помощью специального вызова API.
Пользовательские события можно создавать и удалять из интерфейса консоли маркетолога.

При создании события задается его идентификатор, имя и аргументы. Идентификатор события используется при генерации события. Имя используется для отображения события в интерфейсе, например, при выборе события в условиях запуска рассылки.
Аргументы позволяют передавать дополнительную информацию при генерации события.
При создании пользовательских событий в них может быть добавлено произвольное число аргументов. Например, для события «Клиент воспользовался услугой» можно добавить аргументы «Дата оказания услуги» и «Мастер, который оказывал услугу». Эти аргументы можно будет использовать в текстах сообщений, кнопках рассылки и других текстовых полях аналогично макросам. Таким образом, можно создавать персонифицированные для каждого клиента рассылки.

Редактирование событий
После создания пользовательского события маркетолог может произвольно редактировать все доступные поля и удалить его.
Если хотя бы одна рассылка настроена на старт по данному событию, то его удаление запрещено, редактирование названия и идентификатора рассылки разрешено. Редактирование и удаление аргументов события ограничено созданными в рассылке макросами. Если аргумент события не используется в рассылке, то его можно удалять и изменять. Если используется, то доступно только изменение названия аргумента.
Если хотя бы одна из рассылок, настроенных на старт по данному событию, запущена, то редактирование всех полей события и его аргументов запрещено.

Тестирование рассылок, запускаемых по событию
В интерфейсе консоли маркетолога предусмотрена возможность генерации событий в целях тестирования.
Для этого можно нажать кнопку «Сгенерировать событие» в разделе «События» напротив выбранного события или на странице самого события.
После генерации события с использованием интерфейса Marketer в области «Список launch_result_ids» отображаются специальные ссылки, позволяющие перейти к отладке рассылки.
При переходе по ссылке отображается интерфейс отладки, в котором применен фильтр по выбранному идентификатору запуска (launch_result_id).
Для передачи информации о запросе разработчикам компании, например, для интеграции с CRM, удобно использовать кнопки копирования запроса в формате curl.

При генерации событий при помощи интерфейса консоли маркетолога система не даст ввести значения аргументов, не соответствующие их типу. При генерации событий при помощи API-вызовов также выполняется проверка соответствия типов аргументов. Например, при вызове события с некорректным значением аргумента vip:
curl -X POST -H "Content-Type: application/json" -H "Authorization: Bearer Contoso_:eyJoXfDsaJkKrsGFH..." -d '{ "customer_messenger_id": 13561, "event_name": "numeric_code_for_client", "arguments": { "code": 133442, "discount": 15, "vip": "no" } }' "https://mailing-factory.dev.maxbot.ai/v1/event"
сервер вернет ответ с HTTP-статусом 409:
HTTP/2 409 { "detail": "Argument type error(boolean): no", "key": "argument_type" }

Использование макросов
Макросы позволяют персонифицировать рассылки для клиентов. Например, можно создать рассылку, в тексте которой используются два макроса:
• customer_name — имя и отчество клиента;
• customer_discount — персональная скидка.
Далее можно использовать файл аудитории, в котором заданы значения для используемых макросов.
Каждому клиенту из аудитории рассылки можно задать свои значения, таким образом, сделав рассылку уникальной для каждого клиента.

Поля, в которых можно использовать макросы
Макросы можно использовать почти во всех текстовых полях конструктора рассылок:
• Тексты сообщений;
• Заголовки кнопок;
• URL для кнопок-ссылок;
• URL для медиа-контента;
• Сообщения при переводе в канал;
• Большинство полей настроек вызова внешней системы (кроме названий заголовков запроса и названий параметров запроса);
• Аргументы события при генерации событий;
• Все текстовые поля SMS-блока и настройки вызова внешней системы в SMS-блоке
• Многие текстовые поля других действий9.

Если рассылка начинается при возникновении события, то в рассылку можно добавлять только макросы, названия которых совпадают с именами аргументов события, по которому стартует рассылка. При попытке использовать другой макрос возникнет ошибка. При попытке удалить аргумент события, который используется в рассылке, возникнет ошибка. При попытке сменить событие, по которому запускается рассылка, требуется чтобы у нового события были все аргументы, которые используются в рассылке.

Определение значений макросов для клиентов
Для рассылок, начинающихся по событию, значения макросов передаются в аргументах события. Например, если рассылка началась по событию «Создание промокода для клиента», то в теле рассылки могут быть использованы макросы {{code}}, {{discount}} и {{valid_thru}}.

Макросы могут иметь следующие типы:
• “date” — дата и время (используется формат ISO 8601);
• “decimal“ — число, в т. ч. вещественное;
• “categorical“ — фиксированное число возможных значений;
• “boolean“ — логическое значение;
• “string“ — строка.
Для отправки клиентам в макросах рассылки персонализированных многострочных текстов можно использовать символ разделения строк — \n (в макросах типа «string»). Эта возможность доступна только для API-вызовов, при вызове события из интерфейса (тестовый вызов события из консоли маркетолога) клиент получит \n в тексте рассылки.

Возможные состояния рассылки
Любая рассылка может находиться в одном из 4-х состояний:
• «Не запущена» — состояние рассылки с момента создания и до первого запуска. В этом состоянии пользователь (маркетолог) разрабатывает сценарий рассылки, задает основные настройки и аудиторию.
• «Включена в активном режиме» — в это состояние рассылка переходит поле запуска. В зависимости от настроек условий начала рассылки она начнет выполняться либо сразу, либо при появлении события или тега у клиента, либо при получении ключевого слова от клиента в мессенджере.
• «Включена в пассивном режиме» — в этом состоянии выполняются сценарии рассылок, начавшиеся в активном режиме, но не запускаются новые.
Если рассылка для фиксированной аудитории началась не для всех клиентов, то продолжаться она будет только для тех, для кого началась, а для оставшихся она уже не начнется.
Если рассылка настроена на начало по событию, при выставлении тега клиенту или при получении ключевого слова, то начавшиеся ранее (в активном режиме) сценарии будут продолжать выполняться. Но при появлении новых событий или выставлении тегов или получении ключевых слов рассылка начинаться не будет. Это состояние нужно для того, чтобы дать отработать рассылке для клиентов, для которых она уже началась, но не порождать новые запуски.
• «Отключена» — в этом состоянии рассылка не начинается для новых клиентов и не продолжается для тех, для кого она была начата ранее. Иными словами, клиенты не получают новые сообщения рассылки, а нажатия на кнопки в ранее полученных сообщениях не обрабатываются. Это состояние нужно для полного прекращения рассылки.
---
Дополнительные особенности интерфейса Marketer:
- Изменения при редактировании события применяются автоматически — кнопок "Сохранить" и "Отмена" нет.
- Значения аргументов вводятся при запуске события.
- Типы аргументов задаются при создании через выпадающий список.
- Валидация значений аргументов реализована на frontend с помощью соответствующих контролов:
  - string, decimal — текстовое поле (нельзя ввести буквы в числовое);
  - date — календарь;
  - categorical — выпадающий список;
  - boolean — чекбокс.
- Если пытаться изменить идентификатор аргумента, который используется в макросе рассылки, возникает ошибка.