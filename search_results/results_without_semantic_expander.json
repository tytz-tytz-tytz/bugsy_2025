{
  "query": "Что протестировать при редактировании события?",
  "results": [
    {
      "section_id": "7_настройка_сценария_рассылки",
      "section_title": "Настройка сценария рассылки",
      "level": 0,
      "page_start": 16,
      "page_end": 47,
      "text": "Настройка сценария рассылки\nКонструктор  позволяет  задать  сценарий  рассылки,  который  будет  выполняться  для\nкаждого клиента из аудитории рассылки.\nСценарий рассылки состоит из:\n•  события Start;\n•  блоков действий;\n•  связей между блоками действий.\nПри создании рассылки в конструкторе автоматически создается событие Start, которое\nявляется  начальной  точкой  выполнения  сценария  рассылки.  Также  в  редакторе\nотображается  кнопка  «Добавить  блок»,  при  помощи  которой  в  рассылку  добавляются\nблоки  действий.  События  и  блоки  действий  соединяются  при  помощи  мыши,  образуя\nсвязи.\nВ простейшем случае сценарий рассылки представляет собой событие Start, связанное\nс одним блоком действий (см. Рисунок 19).\n16\nРисунок 19 — Создан сценарий простейшей рассылки\nСобытие Start\nСобытие  Start  происходит  при  запуске  рассылки.  После  возникновения  события  Start\nсразу  или  через  заданное  время  выполняются  связанные  с  ним  блоки  действий  (см.\nдалее).\nБлоки действий\nБлок может содержать одно или несколько действий следующих типов:\n1.  Отправка сообщения;\n2.  Отправка сообщения, содержащего конфиденциальные данные для клиента;\n3.  Перевод в канал;\n4.  Отмена отправки запланированных сообщений этой рассылки;\n5.  Отмена действия кнопок рассылки;\n6.  Вызов внешней системы;\n7.  Генерация события;\n8.  Генерация интента.\nОтправка сообщения\nСообщения могут содержать следующие элементы:\n1.  Текст  сообщения  —  текст,  который  будет  отправлен  клиенту  в  мессенджер.  Для\nввода текста используется поле стандартного блока действий (см. Рисунок 20);\n17\nРисунок 20 — Ввод текстового сообщения для отправки\nПри нажатии на id сообщения (на представленном рисунке это «916») будет открыто\nокно  редактирования,  которое  удобно  использовать  для  ввода  больших  текстов\nрассылок.\n2.  Медиа-контент  —  изображения,  видео,  аудио  и  документы,  которые  могут  быть\nдобавлены к сообщению. Поддерживаются наиболее распространенные форматы\n(см. таблицу 1).\nТаблица 1 — Рекомендуемые форматы файлов и их поддержка в мессенджерах\nТип\nФорматы\nВозможность загрузки файлов\nViber\nВКонтакте\nTelegram\nFacebook*\nInstagram1*\nJPG\nJPEG\nPNG\nMP4\nMP3\nPDF\nDOC(X)\nXLS(X)\nTXT\nИзображение\nВидео\nАудио\nДокумент\nВажно!\nДа\nДа\nДа\nДа\nНет\nНет\nДа\nДа\nДа\nДа\nДа\nДа\nДа\nДа\nДа\nДа\nДа\nДа\nДа\nДа\nСписок  рекомендованных  форматов,  указанный  в  таблице\n1,  не  является\nисчерпывающим.  У  каждого  мессенджера  есть  свой  список,  который  со  временем\nможет  изменяться.  Кроме  того,  необходимо  учитывать,  что  мессенджеры  имеют  свои\nособенности отображения медиа-контента (например, Viber в некоторых случаях не\nпозволяет просматривать изображения в мессенджере).\n1  Отправка  возможна  для  всех  видов  контента.  При  этом,  для  всех  видов  контента,  кроме  изображений,\nотправляется только ссылка на него. Соответственно, клиент не сможет просматривать аудио, видео или\nдокумент  прямо  в  мессенджере  (для  этого  нужно  будет  воспользоваться  браузером  или  другим\nприложением.\n18\nВ  таблице  приведены  наиболее  универсальные форматы,  подходящие  для  отправки\nклиенту  в  большинство  мессенджеров.  Перед  запуском  рассылки  для  клиентов\nнеобходимо предварительно тестировать рассылки на всех мессенджерах.\nДополнительно  нужно  учитывать,  что  для  некоторых  мессенджеров  важно,  чтобы\nистинный  формат  файла  соответствовал  его  расширению  (т. е.  чтобы  изображение\nimage.png действительно имело содержимое, предусмотренное форматом PNG, а не,\nнапример, данные в формате JPEG).\nДля добавления медиа-контента необходимо в блоке действий нажать на кнопку\nв раскрывшемся меню выбрать пункт «Добавить медиа» (см. Рисунок 21).\nи\nРисунок 21 — Переход к добавлению медиа-контента\nЗатем нужно задать тип медиа-контента и ввести ссылку (URL) на него, либо загрузить\nс компьютера при помощи кнопки\n(см. Рисунок 22).\nРисунок 22 — Добавление медиа-контента\n3.  Медиа группа — изображения и видео, которые могут быть добавлены к сообщению\nгруппой.\nВ  отличии  от  предыдущего  пункта,  медиа  группа  позволяет  отправлять  клиенту\nзаранее не определенное количество изображений и видео. Это удобно, например,\nдля  информирования  клиентов  о  результате  проведенных  работ,  когда  одному\n19\nклиенту  нужно  отправить  10  фотографий,  а  другому  15.  С  помощью  медиа  групп  это\nможно сделать одной рассылкой2.\nВторое отличие от одиночных медиа состоит в том, что с медиа группа отправляются\nклиенту  одним  сообщением3,  тогда  как  одиночные  медиа  отправляются  каждое  в\nотдельном сообщении.\nВ  группах  могут  отправляться  только  изображения  и  видео,  документы  и  аудио\nотправляться не могут.\nДля  добавления  группы  необходимо  в  блоке  действий  нажать  на  кнопку\nраскрывшемся меню выбрать пункт «Добавить медиа группу» (см. Рисунок 23).\nи  в\nРисунок 23 — Добавление медиа группы\nВ  открывшемся  окне  можно  добавлять  и  редактировать  ссылки  на  файлы,  которые\nбудут отправляться вместе с указанным сообщением (Рисунок 24).\nРисунок 24 — Редактор медиа групп\n2  Для  реализации  этого  сценария  необходимо  использовать  макросы,  см.  в  разделе  «Использование\nмакросов»\n3  Возможности просмотра одиночных и групп медиа («карусель», предпросмотр в виде плиток и т.д.) зависят\nот мессенджера.\n20\nВ  поле  URL  можно  вставить  как  сам  URL  изображения,  так  и  макрос  (подробнее  о\nмакросах в разделе «Использование макросов»).\nДля  загрузки  файлов  с  устройства  используется  кнопка\n.  Для  клонирования\nэлементов  –\nпоявившемся списке выбрать тип: изображение, видео или макрос.\n.  Для  выбора  типа  файла  необходимо  нажать  на  иконку\nи  в\nЗагруженные элементы отображаются справа. В правой области элементы можно как\nудалять  при  наведении  мышки  и  нажатии  на  кнопку  корзины,  так  и  перемещать  –\nкликнув мышкой на элемент и перетянуть в нужное место см. Рисунок 25.\nВ  левой  области\nтакже  можно  перетаскивать  элементы  и  менять  их\nпоследовательность.  Для  этого  необходимо  кликнуть  мышкой  на  элемент\nперетащить его в нужное место.\nи\nРисунок 25 — Взаимодействие с элементами в правой панели\nВажно!\nМаксимальное количество элементов в медиа группе равно 50. К одному текстовому\nсообщению может быть присоединена только одна медиа группа.\nВо всех полях медиа группы можно использовать макросы.\nРассмотрим случай, когда рассылка с медиа группой будет отправляться клиентам\nпо событию.  Ссылки на изображения мы хотим задавать динамически, в аргументах\nсобытия,  чтобы  мы  могли  отправить  одному  клиенту  11  фотографий,  а  другому  20  из\nодной рассылки. Для этого необходимо:\n1.  Создать  событие,  у  которого  будет  30  аргументов  (это  будет  максимальное\nчисло изображений в медиа группе в этом примере) (Рисунок 26);\n21\nРисунок 26 — Создание события для отправки изображений в медиа группе\n2.  Создать рассылку и настроить ее на начало по этому событию;\n3.  В конструкторе рассылки в блок добавить медиа группу;\n4.  В  медиа  группу  добавить  то  же  самое  количество  URL,  что  и  в  аргументах\nсобытия (см. Рисунок 27);\nРисунок 27 — Использование макросов с изображениями\n5.  В поле URL ввести аргументы события в фигурных скобках, указав в каждом поле\nтолько один аргумент, тип файла оставить как изображение (см. Рисунок 27);\n6.  Сохранить медиа группу.\n22\nПосле этого необходимо сгенерировать событие и в аргументах события указать\nссылки на файлы для отправки клиенту в мессенджер см. Рисунок 28.\nРисунок 28 — Генерация события с аргументами\nЕсли рассылка должна отправлять не только изображения в медиа группе, но и видео,\nтогда в макросах нужно передавать еще и тип медиа. Для этого в аргументах события\nнеобходимо  создать  в  два  раза  больше  аргументов,  чтобы  для  каждого  URL\nпередавался еще и тип, например см. Рисунок 29:\nРисунок 29 — Создания аргументов события для медиа группы\nВ настройках медиа группы для каждого URL выбираем тип \"Макрос\" и задаем URL и\nего тип макросами, как показано на Рисунок 30.\n23\nРисунок 30 — Создания медиа группы с разными типами\nПосле этого необходимо сгенерировать событие и в аргументах события указать\nссылки на файлы и типы для отправки клиенту в мессенджер, например, см. Рисунок\n31.\nРисунок 31 — Генерация события для медиа группы с типами медиа\n4.  Кнопки-действия — это кнопки, позволяющие выполнять следующие действия:\n•  Вызвать другой блок действий;\n•  Добавить клиенту теги;\n•  Снять теги с клиента;\n•  Отписать клиента от рассылок (всех)4.\nДля добавления кнопки-действия необходимо в блоке действий нажать на кнопку\nи в раскрывшемся меню выбрать пункт «Добавить кнопку-действие» (см. Рисунок 32).\n4 Действие эквивалентно тому, что клиент напишет боту команды «стоп рассылки» или «stop subscriptions»,\nсм. раздел Отписка от рассылок.\n24\nРисунок 32 — Переход к добавлению кнопки-действия\nЗатем  нужно  задать  требуемые  параметры  кнопки  и  нажать  на  кнопку  «Сохранить»\n(см.  Рисунок  33).  Для  каждой  кнопки  можно  указать  теги,  которые  будут  назначены\nклиенту (сняты с клиента), подробнее об этом см. в подразделе Работа с тегами.\nРисунок 33 — Добавление кнопки-действия\nПримечание:\nДлина заголовка кнопки должна быть не более 20 символов.\nДействия  в  блоке,  связанном  с  кнопкой,  всегда  выполняются  сразу  после  нажатия\nкнопки.  (см.  Рисунок  34).  Блок,  вызываемый  кнопкой-действием,  может  содержать\nлюбое из действий, описанных в разделе Блоки действий.\n25\nРисунок 34 — Второй блок выполняется сразу при нажатии на кнопку\nНа  одну  кнопку  клиент  может  нажать  только  один  раз.  Повторные  нажатия  не\nобрабатываются.  Если  сценарий  рассылки  предусматривает  возврат  к  блоку,\nкоторый клиент уже получал, то на кнопку можно будет нажать еще раз (см.  Рисунок\n35). В этом примере при нажатии на кнопку «Назад» клиент получит первый блок еще\nраз и именно в нем можно будет еще раз нажать на кнопку «Подробнее».\nРисунок 35 — Пример возврата\nПри  добавлении  к  сообщению  более  двух  кнопок-действий  появляется  опция\n«Разрешить только одно нажатие» (см. Рисунок 36).\nЕсли  она  установлена,  то  клиент  может  нажать  только  на  одну  кнопку  в  этом\nсообщении.  После  первого  нажатия  аналогичные  нажатия  по  другим  кнопкам  не\nобрабатываются.  Если  опция  не  установлена,  то  на  каждую  кнопку  в  сообщении\nможно нажать один раз.\n26\nРисунок 36 — В блок добавлено две кнопки-действия\nВажно!\nОписанное выше относится только к кнопкам сообщения, а не блока. В один блок может\nбыть добавлено несколько сообщений, каждое из которых будет содержать по нескольку\nкнопок. В этом случае при включенной опции «Разрешить только одно нажатие» в каждом\nсообщении можно будет нажать по одной кнопке.\nВ некоторых мессенджерах текст сообщений с кнопками может обрезаться. Т.е. клиент\nувидит  не  весь  отправленный  ботом  текст,  а  только  первые  несколько  символов.\nПредупреждение об этом всплывет справа у окна с текстом см. Рисунок 37. Например, в\nмобильной  версии  Viber  будет  отображаться  только  первые  40  символов  сообщения  с\nкнопкой, а в десктопной версии – первые 10.\nРисунок 37 - Текст с кнопкой, который обрежется в некоторых мессенджерах\nЧтобы  обойти  эту  проблему  рекомендуем  добавлять  отдельное  сообщение  перед\nсообщением с кнопкой и задавать в нем основной текст, а в сообщении с кнопкой писать\nчто-то короткое см. Рисунок 38.\n27\nРисунок 38 - Добавлено отдельное сообщение\n5.  Кнопки-ссылки  —  кнопки,  позволяющие  клиенту  перейти  по  заданной  ссылке  из\nмессенджера.\nДля добавления кнопки-ссылки необходимо в блоке действий нажать на кнопку\nраскрывшемся меню выбрать пункт «Добавить кнопку-действие» (см. Рисунок 39).\nи в\nРисунок 39 — Переход к добавлению кнопки-ссылки\nЗатем необходимо задать название кнопки и ссылку для нее (см. Рисунок 40).\nРисунок 40 — Создание кнопки-ссылки\n28\nСсылка  клиенту  не  отображается.  Нажатия  на  кнопку-ссылку  не  могут  приводить  к\nзапуску  другого  блока  или  иным  действиям,  а  также  никак  не  учитываются  в\nстатистике.\nПримечание:\nКлиент  может  нажимать  на  ссылки  многократно,  описанные  выше  ограничения  по\nнажатиям на них не действуют.\nОтправка сообщения, содержащего конфиденциальные данные для клиента\nВ  общем случае  вся  переписка клиента  с  ботом доступна  оператору  Maxbot. Если  бот\n(например,  кодов\nиспользуется  для  отправки  конфиденциальной  информации\nподтверждения), то такую информацию необходимо скрывать от оператора.\nДля  отправки  конфиденциальной  информации  в  теле  блока  с сообщением  необходимо\nиспользовать  тег  <security>…</security>  (см  Рисунок  41).  Вставка  закрывающего  тега\nобязательна.\nРисунок 41 — Отправка конфиденциальной информации при помощи тега <security></security>\nДанные, заключенные в теге <security>, для оператора заменяются на ***. То, что увидят\nклиент и оператор при запуске такой рассылки, показано на рисунке ниже:\nРисунок 42 — Отображение содержимого тега <security> для клиента и для оператора\nНа  практике  использование  тега  <security>  будет  сопровождаться  использованием\nмакроса,  т. е.  конфиденциальная  информация  вряд  ли  будет  задаваться  в  рассылке\nстатически.  В  этом  случае  тег  <security>  нужно  использовать  следующим  образом  (см.\nРисунок 43), поместив внутрь макрос, который является аргументом события:\n29\nРисунок 43 — Использование значения макроса в качестве конфиденциальной информации\nПеревод в канал\nДействие перевода в канал выполняется сразу, если диалог у клиента закрыт или диалог\nсвободный5  или  иное  на  задано  в  настройках  действия  (см.  далее).  При  наличии\nоткрытого диалога перевод выполнен не будет, чтобы не помешать текущему общению\nклиента  с  оператором.  Перевод  будет  отложен  до  тех  пор,  пока  диалог  у  клиента  не\nбудет закрыт или не будут выполнены условия, заданные в настройках действия.\nДля добавления действия перевода в канал нужно нажать на кнопку\nи в раскрывшемся\nменю  выбрать  пункт  «Действие»,  после чего  выбрать  «Перевести  в  канал»  (см.  Рисунок\n44):\nРисунок 44 — Выбор действия\nЗатем в открывшемся окне (см. Рисунок 45) необходимо задать параметры для действия\nперевода в канал.\nВ окне доступны следующие настройки:\n•  Выберите канал — канал, в который необходимо перевести клиента;\n5 Свободный диалог — диалог, у которого канал Bot.\n30\n•  Текст  при  переводе  в  канал  —  сообщение,  которое  будет  отправлено  клиенту  при\nпереводе в канал (если оставить его пустым, то сообщение не будет отправляться);\n•  Текст  при  откладывании  перевода  в  канал  —  сообщение,  которое  будет  оправлено\nклиенту,  если  в  момент  выполнения  действия  у  него  есть  открытый  диалог  и  он  не\nсвободный (т. е. клиент обсуждает с оператором или ботом какой-то вопрос);\n•  Текст перед отложенным переводом в канал — сообщение, которое будет отправлено\nклиенту при переводе в канал, если он ранее был отложен;\n•  Переключатель условия перевода в канал:\n•  Перевести сразу (значение по умолчанию) — клиент будет переведен в канал без\n(кроме  наличия  открытого/свободного\nкаких-либо  дополнительных  условий\nдиалога);\n•  Перевести  после  получения  сообщения  от  клиента  —  клиент  будет  переведен\nтолько  после  получения  от  него  сообщения  и  в  соответствии  с  настройками,\nуказанными ниже;\nРисунок 45 — Настройка действия перевода в канал\n31\n•  Время ожидания сообщения — время, которое бот ожидает сообщения от клиента для\nперевода  его  в  канал.  Можно  установить  время  не  более  2  часов  (ограничение\nвведено,  чтобы  маркетолог  не  мог  надолго  «блокировать»  клиента:  поскольку  в\nмомент ожидания не могут выполняться другие рассылки, а также клиенту не смогут\nотправлять сообщения операторы);\n•  Если  клиент  не  ответил  за  заданное  время  —  действие,  которое  бот  выполнит,  не\nдождавшись сообщения от клиента в течение «времени ожидания сообщения»:\n•  «Ничего не делать» — бот не будет предпринимать каких-либо действий; клиент не\nбудет переведен в канал, рассылка при этом продолжится согласно сценарию;\n•  «Перевести  в  канал  безусловно»  —  клиент  будет  переведен  в  канал,  при  этом\nможно задать другой канал (отличный от исходно заданного);\n•  «Отправить сообщение» — клиенту будет отправлено сообщение, заданное в поле\nниже; клиент не будет переведен в канал.\nЕсли для рассылки ниже (см. Рисунок 46) задать безусловный перевод клиента в канал по\nфакту  нажатия  на  кнопку  «Оставить  отзыв»,  то  клиент  будет  переведен  сразу,  какого-\nлибо сообщения от него не требуется.\nРисунок 46 — Пример рассылки с переводом в канал\nВ  этом  случае  оператор  увидит  нового  клиента  в  списке  диалогов,  но  сообщение  от\nклиента будет отсутствовать (см. Рисунок 47).\nРисунок 47 — Клиент переведен в канал без сообщения\n32\nЕсли  же  в  настройках  перевода  в  канал  потребовать  ввод  сообщения  от  клиента  (см.\nРисунок 48), то новый диалог появится только после отправки клиентом сообщения.\nРисунок 48 — Ввод условия перевода клиента в канал только при наличии от него сообщения\nВ этом случае оператор уже сразу увидит текст сообщения и не будет тратить время на\nвыяснение причины и содержания обращения (см. Рисунок 49).\nРисунок 49 — Клиент переведен в канал после отправки им сообщения\nОтмена отправки запланированных сообщений\nЭто  действие  позволяет  маркетологу  остановить  рассылку  для  клиента  при\nвозникновении  некоторого  события.  Например,  при  нажатии  кнопки,  при  отправке\nфинального сообщения рассылки, при истечении определенного времени.\nДля  добавления  действия  нужно  нажать  на  кнопку\nи  в  раскрывшемся  меню  выбрать\nпункт «Действие», после чего выбрать «Отключить рассылку запланированных, но еще не\nотправленных сообщений» (см. Рисунок 50):\n33\nРисунок 50 — Выбор действия\nНа  рисунке  51  показан  пример  такого  сценария.  Если  клиент  нажмет  на  кнопку  «Не\nинтересуюсь  этим»,  робот  отправит  извинительное  сообщение  и  отключит  отправку\nзапланированных сообщений. В данном случае это правое нижнее сообщение, которое\nпредполагалось отправить через 5 дней.\nЕсли  клиент  в  течение  5  дней  не  нажмет  эту  кнопку,  то  он  получит  запланированное\nсообщение с информацией о продлении акции.\nРисунок 51 — Пример использования события отмены отправки запланированных сообщений\nВажно!\nДействие отмены отправки запланированных сообщений применяется ко всей рассылке\nдля текущего клиента, независимо от того, из какой ветви сценария оно было вызвано.\n34\nОтмена работы уже отправленных в рассылку кнопок\nЭто  действие  работает  аналогично  предыдущему,  только  отменяет  не  отправку\nсообщений, а работу кнопок в сообщениях. Вместе с предыдущим действием позволяет\nполностью деактивировать рассылку для клиентов, у которых они будут выполнены.\nи  в  раскрывшемся  меню  выбрать\nДля  добавления  действия  нужно  нажать  на  кнопку\nпункт «Действие», после чего выбрать «Отключить работу уже отправленных в рассылку\nкнопок» (см. Рисунок 52):\nРисунок 52 — Выбор действия\nВ следующем сценарии (см. Рисунок 53) при нажатии на кнопку «Не интересуюсь этим»\nпроизойдет не только отмена запланированного сообщения, но и перестанет работать\nкнопка, отправленная клиенту в первом сообщении.\nРисунок 53 — Использование действия отмены работы уже отправленных в рассылку кнопок\n35\nВажно!\nЭто  действие  отменяет  только  работу  кнопок-действий.  Кнопки-ссылки  будут  всегда\nдоступны, клиенты смогут переходить по ним произвольное число раз.\nДействие  отмены  работы  кнопок  применяется  ко  всей  рассылке  для  текущего  клиента,\nнезависимо от того, из какой ветви сценария оно было вызвано.\nВызов внешней системы\nДействие  «Вызвать  внешнюю  систему»  предназначено  для  уведомления  внешней\nсистемы о достижении клиентом того или иного этапа рассылки.\nи в раскрывшемся\nДля добавления вызова внешней системы нужно нажать на кнопку\nменю  выбрать  пункт  «Действие»,  после  чего  выбрать  «Вызвать  внешнюю  систему»  (см.\nРисунок 54).\nРисунок 54 — Выбор действия\nДалее необходимо задать параметры запроса к внешней системе. Для примера далее\nзаполнено  обращение  к  CRM  компании  для  того,  чтобы  отметить  интерес  клиента  к\nопределенной  теме  в  случае  нажатия  на  определенную  кнопку  (см.  Рисунок  55).  В\nдальнейшем в CRM это можно будет использовать для сегментации аудитории.\nПример  ниже  отражает  вариант  запроса,  при  выполнении  которого  в  CRM  компании\nсохраняются данные о том, что клиент с идентификатором 12443 интересуется товарами\nв категории «наушники» (headphones).\nКроме  строковых  и  числовых  параметров  также  могут  использоваться  макросы,  см.\nподробнее в разделе Использование макросов.\n36\nРисунок 55 — Ввод параметров запроса к внешней системе\nЕсли в блоке есть действие вызова внешней системы, то оно всегда выполняется первым.\nЕсли вызов завершается ошибкой (сервер возвращает HTTP-статус, отличный от 200 или\nне  отвечает  в  течение  времени,  заданного  в  поле  «Максимальное  время  выполнения\nзапроса»), то остальные действия блока не выполняются. Если к текущем блоку привязаны\nпоследующие блоки (т. е. выполняются после отправки сообщения из этого блока), то они\nтакже не будут выполнены.\nПримечание:\nВ текущей версии «Максимальное время выполнения запроса» и все подобные таймауты\nвременно равны 0.5 секунды вне зависимости от заданного значения.\nГенерация события\nБлок  этого  типа  позволяет  вызывать  события  и  использовать  их  для  запуска  других\nрассылок из текущей рассылки.\nЕсли клиент по сценарию рассылки перейдет к действию «Сгенерировать событие», то\nэто  событие  будет  сгенерировано  либо  только  для  него;  если  для  события  задана\nфиксированная  аудитория  (см.  подробнее  в  разделе  Определение  аудитории),  то\nсобытие  будет  сгенерировано  для  нее  (будет  запущена  рассылка  для  множества\n37\nклиентов). Это позволит начать одну или несколько других рассылок. Текущая рассылка\nпри этом не будет остановлена, ее сценарий продолжит выполняться.\nРисунок 56 — Выбор действия «Сгенерировать событие\nНапример,  есть  рассылка,  предлагающая  клиенту  воспользоваться  промокодом  (см.\nРисунок 57). Если клиент нажимает на кнопку, то во втором блоке рассылки генерируется\nсобытие «Создание промокода для клиента».\nПримечание:\nСобытие,  используемое  в  сценарии  рассылки,  должно  быть  предварительно  создано.\nПодробнее об этом см. в разделе Использование событий.\nРисунок 57 — Рассылка, в сценарии которой генерируется событие для клиента\nВ аргументах события, генерируемого для клиента, нужно задать требуемые значения. В\nнашем случае нужно задать значения для 3-х аргументов (см. Рисунок 58):\n•  промокод — строка;\n38\n•  размер скидки (%) — число;\n•  действует до — строка.\nРисунок 58 — Событие «Создание промокода для клиента» и его аргументы\nПример ввода значений аргументов события показан на рисунке 59.\nПри  указании  строковых  значений  необходимо  использовать  символ  кавычек  (“);\nчисловые значения и даты задаются без кавычек. Значение аргумента также может быть\nпустым (не задано).\nПри этом могут быть заданы как статические значения аргументов (в примере выше), так\nи динамические — макросы, уникальные для каждого клиента.\nПереключатель  под  названием  события  определяет,  для  кого  будет  сгенерировано\nсобытие:\n•  только для текущего клиента\nили\n•  для множества клиентов (для рассылок с фиксированной аудиторией).\n39\nРисунок 59 — Ввод аргументов для события\nТеперь  можно  создать  вторую  рассылку,  которая  будет  выполняться  при  генерации\nсобытия в первой рассылке. Ниже пример такой рассылки (см. Рисунок 60):\nРисунок 60 — Вторая рассылка, запускаемая по сгенерированному событию и использующая\nзначения аргументов события\nПримечание:\nЕсли  рассылка  запускается  по  событию,  то  его  аргументы  можно  использовать  в\nрассылке  как макросы.  На  рисунке  выше  во  второй  рассылке  при  помощи  скобок  {{  }}\nиспользуются значения аргументов сгенерированного события.\nДля данной рассылки нужно выбрать условие «Начинать при возникновении события» и\nсобытие  «Создание  промокода  для  клиента»  (см.  Рисунок  61),  после  чего  запустить  ее.\nРассылка будет «ожидать» выбранного события и выполнится у клиентов, для которых оно\nнаступило.\n40\nРисунок 61 — Определение условий начала второй рассылки\nЕсли  в  результате  выполнения  первой  рассылки  (см.  Рисунок  57)  клиент  нажмет  кнопку\n«Получить  промокод»,  то  в  результате  выполнения  второй  рассылки  будут  получены\nданные промокода (см. Рисунок 62).\nРисунок 62 — После нажатия на кнопку «Получить промокод» для клиента выполнилась вторая\nрассылка\nГенерация интента\nБлок  этого  типа  позволяет  сгенерировать  интент  (intent)  —  намерения  пользователя,\nкоторые могут быть распознаны системой для того, чтобы затем вызвать определенный\nнавык бота.\n41\nДля вызова навыков бота необходимо:\n1.  Нажать  на  кнопку\nи  в  раскрывшемся меню  выбрать  пункт «Действие»,  после  чего\nвыбрать «Сгенерировать intent» (см. Рисунок 63).\nРисунок 63 — Выбор действия «Сгенерировать intent»\n2.  В  настройках  действия  (см.  Рисунок  64)  задать  название  интента  и  (необязательно)\nсловарь сущностей (entities). Важно, что в поле «Entities» должен быть задан именно\nсловарь в формате JSON (как на рисунке ниже), иначе выполнение сценария рассылки\nзавершится ошибкой.\nВ словаре могут быть использованы как макросы и переменные окружения (в нотации\n«slots.m.macros_name»),  так  и  статические  значения.  Этот  словарь  должен  быть\nвалидным jinja-выражением.\nКонстантные выражения также нужно задавать правильно — строки только в кавычках,\nчисла — без, и они не должны оставаться пустыми.\nРисунок 64 — Ввод параметров интента\n42\n3.  Нажать на кнопку «Сохранить».\nВ результате выполнения этого действия бот сгенерирует указанный интент и передаст\nslots  в  качестве  параметров.  Это  позволит  запустить  нужный  навык  бота  для  клиента\n(например, выбор определенного товара или услуги).\nПримечание:\nЧтобы бот выполнил определенное действие, навыки бота должны быть предварительно\nнастроены.\nВ перспективе это действие должно вытеснить большинство переводов в канал – вместо\nтого,  чтобы  передавать  клиента  оператору  и  занимать  его  время,  рассылка  будет\nвызывать соответствующий навык бота.\nБлок-комментарий\nВ  рассылки любого  типа  можно  вставить блок-комментарий,  который  будет содержать\nпроизвольный текст. Для добавления блока-комментария к рассылке необходимо в левом\nнижнем  углу  нажать  на  кнопку  «Добавить  блок»,  после  чего  выбрать  значение\n«Комментарий» (см. Рисунок 65) и перетащить его на область сценария рассылки.\nРисунок 65 — Добавления блока-комментария\nБлок  данного  типа  является  информационным:  он  не  имеет  каких-либо  настроек  (за\nисключением текста комментария) и не может иметь связей с другими блоками рассылки.\nБлок «SMS-сообщения»\nВ  рассылку  также  можно  добавить  блок  «SMS-сообщения»,  выбрав  соответствующий\nпункт  в  меню  добавления  блоков  (см.  Рисунок  66).  Блок  позволяет  отправлять  клиентам\nSMS-сообщения,  а  также  направлять  клиентов  на  посадочную  страницу  для\nподключения мессенджера и автоматического подтверждения номера телефона.\nПодробнее  об  использовании  блока  «SMS-сообщения»  см.  в  разделе  Настройка  SMS-\nрассылок.\n43\nРисунок 66 — Добавления блока «SMS-сообщения»\nПримечание:\nПо  умолчанию  после  создания  рассылки  добавление  блока  «SMS-сообщения»\nнедоступно. Для разблокирования этой возможности необходимо сначала выбрать SMS-\nпровайдера,  см.  подробнее  в  разделах  Регистрация  SMS-провайдера  и  Добавление\nSMS-провайдера в рассылку.\nБлок «Форма»\nПри  необходимости  проведения  опроса  клиентов  можно  добавить  в  рассылку  блок\n«Форма»  (см.  Рисунок  67).  Блок  позволяет  при  помощи  конструктора  задать  порядок\nпроведения опроса, а также форматы вопросов и ответов.\nПодробнее о возможностях данного блока и особенностях его применения в рассылках\nсм. в разделе Опрос клиентов с помощью форм.\nРисунок 67 — Добавления блока «Форма»\nСвязи между блоками действий\nСвязь между событием и блоком означает безусловное выполнение действий блока сразу\nили через заданный промежуток времени после возникновения события.\nТаким  образом,  связь  всегда  исходит  из  событий  и  заканчивается  в  блоке  действий.  В\nодин блок действий могут приходить несколько связей.\n44\nСписок событий, из которых может исходить связь:\n1.  Событие Start, т. е. начало выполнения сценария рассылки (см. Рисунок 68);\nРисунок 68 — Связь исходит из события Start\n2.  Нажатие на кнопку-действие (см. Рисунок 69);\nРисунок 69 — Связь исходит из кнопки «Узнать подробности»\n3.  Отправка  сообщения  клиенту.  От  события  отправки  сообщения  также  можно\nстроить связь, для этого следует начать связь из точки в правом нижнем углу (см.\nРисунок  70).  Важно,  что  это  событие  происходит  только  когда  сообщение\nнепосредственно ставится в очередь на отправку, а не когда сообщение должно\nбыло отправиться.\nНапример,  в  приведенном  ниже  рисунке  второе  сообщение  должно  отправиться\nчерез 5 дней. Если первое сообщение не отправилось сразу после начала рассылки\n(например, у клиента был открыт диалог и его закрыли только через 1 день), то второе\nотправится  только  через  5  дней  после  отправки  первого,  т. е.  через  6  дней  после\nначала  рассылки  (а  не  через  5,  как  это  может  показаться  из  сценария).  Поэтому\nрассылки с подобными связями могут растягиваться на неопределенное время.\n45\nРисунок 70 — Связь исходит из блока с сообщением\nИз  события  Start  может  исходить  произвольное  количество  связей.  Из  остальных\nсобытий — только  по  одному.  У  всех  связей,  кроме  тех,  что  исходят  из  кнопок,  можно\nзадать задержку (см. Рисунок 70).\nТакже стоит отметить, что этой точки в правом нижнем углу нет, если в блоке нет действия\nотправки сообщения (не от чего отталкиваться).\nДублирование блоков\nЕсли  необходимо  быстро  скопировать  блок  со  всем  его  содержимым,  то  необходимо  в\nверхней части нажать на\nРисунок 71).\nи затем в раскрывшемся меню выбрать «Дублировать» (см.\nРисунок 71 — Вызов функции дублирования блока\nУпорядочивание сообщений в блоке\nЕсли  блок  имеет  несколько  сообщений,  то  их  можно  упорядочить.  Чтобы  сделать  это,\nнеобходимо  нажать  напротив  нужного  сообщения  на\n,  затем  в  открывшемся  меню  с\nпомощью  пунктов  «Переместить  наверх»  и  «Переместить  вниз»  определить\nместоположение сообщения (см. Рисунок 72).\n46\nРисунок 72 — Определение местоположения сообщения\nУдаление сообщений из блока\nНенужные сообщения из блока можно удалить. Чтобы сделать это, нужно нажать напротив\n, в открывшемся меню выбрать пункт «Удалить» (см. Рисунок 73), затем во\nсообщения на\nвсплывающем окне подтвердить удаление.\nРисунок 73 — Удаление сообщения из блока\n47\nКонтроль  изменения  сценария  и  настроек  рассылки  в\nнескольких окнах браузера\nВ  Maxbot  функционирует  механизм,  отслеживающий  редактирование  сценария  и\nнастроек  рассылки  в  разных  окнах  (вкладках)  браузера.  Это  сделано  для  того,  чтобы\nправки в ранее открытой вкладке не могли «затереть» изменения, сделанные в другой.\nМеханизм контроля работает следующим образом. Например, если открыть рассылку в\nдвух  вкладках,  отредактировать  ее  в  первой  вкладке,  а  затем  попытаться\nотредактировать  во  второй,  то  будет  отображено  следующее  сообщение  (см.  Рисунок\n74).  Аналогичное  сообщение  будет  отображено  в  случае,  когда  одна  рассылка\nодновременно редактируется двумя или более маркетологами\nРисунок 74 — Ошибка при одновременном редактировании сценария в разных вкладках\nбраузера\nВ  этом  случае  необходимо  обновить  страницу  для  продолжения  редактирования\nсценария  рассылки  в  этом  окне.  Изменение,  которое  привело  к  появлению  этого\nсообщения, не сохранится.",
      "tags": [
        "аргумент",
        "блок",
        "диалог",
        "идентификатор",
        "макрос",
        "мессенджер",
        "настройк",
        "ограничен",
        "ошибк",
        "рассылк",
        "редактирован",
        "событ",
        "тег",
        "тест",
        "тип"
      ]
    },
    {
      "section_id": "102_отладка",
      "section_title": "Отладка",
      "level": 0,
      "page_start": 135,
      "page_end": 145,
      "text": "Отладка\nТип связи между блоком-источником и блоком, действия\nкоторого были выполнены:\ntimeout  –  задержка  после  отправки  сообщения  из\nблока-источника;\nbutton_click – нажатие кнопки в блоке-источнике;\ndirect – связь от события start (при этом задержка может\nбыть ненулевой).\nИдентификатор  кнопки,  которая  нажата  в  блоке-\nисточнике перехода\nНазвание  кнопки,  которая  нажата  в  блоке-источнике\nперехода\nАргументы, указанные при генерации события, которое\nинициировало  начало  этой  рассылки  для  данного\nклиента\nПри  работе  с  рассылками,  которые  начинаются  при  возникновении  события,  часто\nнеобходимо  узнать,  почему  клиент  или  множество  клиентов  не  получили  рассылку.  В\nконсоли  маркетолога  есть  специальный  раздел  «Отладка»,  который  помогает\nразобраться,  что  произошло  после  возникновения  определенного  события  (вкладка\n«События») или запуска рассылки (вкладка «Рассылки»).\n135\nРисунок 179 — Раздел «Отладка»\nАудит вызовов событий\nНа вкладке «События» можно найти информацию о попытках сгенерировать то или иное\nсобытие. Поиск возможен по дате события, а также по его характеристикам. (для этого\nнужно нажать на иконку фильтра, см. Рисунок 180):\nРисунок 180 — Поиск события по его характеристикам\nПеречень  доступных  фильтров  и  их  описание  приведены  в  таблице  10.  Между  собой\nфильтры применяются по условию «И», т. е. возвращаются результаты, удовлетворяющие\nвсем фильтрам.\n136\nТаблица 10 — Описание фильтров для поиска событий\nФильтр\nДата\nНазвание события\nСписок\nидентификаторов\nрассылок\nСписок\nlaunch_result_ids\nИдентификатор\nбота\nИдентификатор\nклиента\nИмя клиента\nНомер телефона\nТипы запуска\nрассылки по\nсобытию\nОписание\nДата попытки сгенерировать событие. Единственный\nобязательный фильтр для выполнения поиска.\nВ этом фильтре может быть указано полное название события\nили его часть (выполняется поиск заданной подстроки в\nназвании события).\nИдентификаторы рассылок, которые начаты в результате\nвызова события. Фильтр применяется по условию «ИЛИ», т. е.\nвозвращаются результаты, удовлетворяющие хотя бы одному из\nзаданных значений.\nИдентификаторы запусков (launch_customer_ids или\nsms_launch_customer_ids или delayed_trigger_event_id, или\nunsubscribed_trigger_event_id), полученные в результате\nгенерирования событий. Фильтр применяется по условию\n«ИЛИ», т. е. возвращаются результаты, удовлетворяющие хотя\nбы одному из заданных значений.\nВ этом фильтре может быть указано полное системное название\nбота или его часть, т. е. выполняется поиск заданной подстроки.\nИдентификатор клиента, для которого началась рассылка в\nрезультате возникновения события.\nИмя клиента, для которого началась рассылка в результате\nвозникновения события.\nПолный номер телефона клиента или его часть, для которого\nначалась рассылка в результате возникновения события. Т.е.\nвыполняется поиск заданной подстроки\nПозволяет отфильтровать события по «последствиям» запуска.\nМожно задать одно или несколько значений из:\nвызова\n•  «Ожидание  подтверждения  телефона»  –  события,  в\nожидание\nкоторых\nрезультате\nподтверждения клиентом номера телефона (случай, когда\nв\nвозвращается\ndelayed_trigger_event_id).\nрезультате\nначалось\nсобытия\nвызова\n•  «Ожидание подписки на бота в мессенджере» – события, в\nрезультате вызова которых началось ожидание подписки\n(случай,  когда  в\nклиента  на  бота  в  мессенджере\nрезультате\nвозвращается\nсобытия\nunsubscribed_trigger_event_id).\nвызова\n•  «Передано  в  транспорт  мессенджера»  –  события,  в\nрезультате вызова которых началось отправка рассылки в\nмессенджер  (случай,  когда  в  результате  вызова  события\nвозвращается launch_customer_ids).\n137\nФильтр\nОписание\n•  «Передано  в  SMS-провайдер»  –  события,  в  результате\nвызова которых началось отправка SMS-рассылки (через\nSMS-провайдер,  случай,  когда  в  результате  вызова\nсобытия возвращается sms_launch_customer_ids).\nРезультат вызова\nсобытия\nСтатус-код запроса вызова события:\n•  200 — запрос выполнен успешно;\n•  40X – различные виды ошибок.\nСписок возможных\nисточников события\nОдин или несколько источников, откуда сгенерировано\nсобытие:\n•  Рассылка  –  события,  сгенерированные  из  сценария\nв\n«Сгенерировать\n(действие\nсобытие»\nрассылки\nконструкторе рассылок);\n•  Интерфейс  –  события,  сгенерированные  из  консоли\nмаркетолога;\n•  API  –  события,  сгенерированные  путем  вызова  одного  из\nзапросов API;\n•  Системное\nсобытие\nсобытия,\n–\nсгенерированные  ботом  (в  текущей  версии  Maxbot  это\n«Подтверждение номера телефона» и «Добавление нового\nклиента»).\nсистемные\nСостояние запусков\nрассылки для\nклиента\nСтатус запуска рассылки для клиента:\n•  «Готов к отправке» — рассылка готова к началу, но еще не\nначалась;\n•  «Рассылка началась успешно»;\n•  «Ошибка при запуске рассылки»;\n•  «Пропущен, в рассылке нет SMS-блока» — сгенерировано\nсобытие для отправки SMS, но в рассылке нет SMS-блока;\n•  «Пропущен, входит в аудиторию другой рассылки»;\n•  «Клиент отписался от рассылок»;\n•  «Клиент не оплачен»;\n•  «Клиент уже получал рассылку»;\n•  «Рассылка не успела начаться» – рассылка не началась,\nт. к. ее остановили, не успев начать ее для клиента;\n•  «Ошибка при запуске SMS-рассылки»;\n138\nФильтр\nОписание\n•  «Ошибка при вызове внешней системы в SMS-блоке»;\n•  «Ошибка при генерации диплинка для SMS-блока» — при\nотправке  SMS-рассылки  с  лендингом  при  генерации\nдиплинка возникла ошибка;\n•  «Телефон  подтвержден  до  попытки  отправить  SMS»  —\nклиент  подтвердил  номер  телефона  до  отправки  SMS,\nотправка будет осуществлена через мессенджер;\n•  «Ожидает  подписки  клиента  в  мессенджере»  —  начало\nрассылки  отложено  до  подписки  клиентом  на  бота  в\nмессенджере;\n•  «Ожидает  подтверждения  номера  телефона»  —  начало\nрассылки  отложено  до  подтверждения  клиентом  номера\nтелефона.\nВ  результате  применения  фильтров  отображаются  записи  о  попытках  сгенерировать\nсобытия, удовлетворяющие всем заданным условиям.\nЕсть два режима отображения результатов:\n•  режим карточек (см. Рисунок 181);\n•  режим списка (см. Рисунок 182).\nРисунок 181 — Просмотр найденных событий (режим карточек)\n139\nРисунок 182 — Просмотр найденных событий (режим списка)\nРежимы  отличаются  только  визуально,  переключение  между  ними  выполняется  при\nпомощи иконки справа от фильтра.\nПри нажатии на ссылку в поле «ID» можно перейти на страницу с детальной информацией\nо сгенерированном событии. Эта страница разделяется на две части. В верхней части\nстраницы  отображается  общая  информация  о  сгенерированном  событии  (см.  Рисунок\n183):\n•\nID — идентификатор записи о генерации события в журнале аудита событий;\n•  Источник  —  источник,  откуда  пришел  запрос  на  генерацию  события.  См.  «Список\nвозможных источников события» выше;\n•  Рассылка  —  название  рассылки,  если  событие  было  сгенерировано  из  сценария\nрассылки;\n•  Дата — дата генерации события;\n•  Название события из запроса — название события, как оно было указано в запросе;\n•\n•\nID события — идентификатор события в системе;\nID клиента — идентификатор клиента, для которого было сгенерировано событие;\n•  Мессенджер — мессенджер клиента, для которого было сгенерировано событие;\n•  Телефон — телефон клиента, для которого было сгенерировано событие;\n•  Тип — тип запроса на генерацию события. Возможные варианты:\n•  По идентификатору клиента;\n•  По номеру телефона;\n•  Для рассылок с фиксированной аудиторией;\n140\n•  Запрос — тело запроса на генерацию события. Для просмотра и копирования нужно\nнавести мышью на «глазок»;\n•  Статус-код — HTTP status code ответа на запрос генерации события;\n•  Ответ  —  тело  ответа  на  запрос  генерации  события.  Для  просмотра  и  копирования\nнужно навести мышью на «глазок».\nРисунок 183 — Общая информация о сгенерированном событии\nВ  нижней  части  страницы  отображается  информация  о  рассылках,  начавшихся  в\nрезультате  возникновения  события,  либо  информация  о  начавшемся  ожидании\nподтверждения номера телефона или подписки клиента в мессенджере. Информация на\nстранице  с  деталями  события  позволяет  понять,  началась  ли  рассылка  при  вызове\nсобытия,  а  также  ответить  на  вопросы  –  если  рассылка  началась,  то  какая,  и  если  не\nначалась,  то  почему.  Далее  в  подразделах  приведены  примеры  вывода  такой\nинформации.\nРассылка  в  мессенджер  (одна  или  несколько)  началась  сразу  после  возникновения\nсобытия\nСведения о начавшихся рассылках в мессенджере содержат (см. Рисунок 184):\n•\nID — идентификатор записи о генерации события в журнале аудита событий;\n•  Дата — дата генерации события;\n•  MID — идентификатор начавшейся рассылки. При нажатии на ссылку можно перейти\nна  страницу  с  информацией  о  ходе  выполнения  рассылки  для  этого  клиента.\nПодробнее это описано в разделе Просмотр хода выполнения рассылок;\n•  Рассылка — название рассылки, которая началась в результате вызова события. При\nклике по ссылке можно перейти на страницу редактирования рассылки;\n•  Launch  —  идентификатор  запуска  рассылки,  получаемый  при  генерации  события  (в\nполе launch_customer_ids ответа на запрос генерации события);\n141\n•  Запуск, Остановка — даты запуска и остановки рассылки соответственно (в текущей\nверсии Maxbot) не заполняется;\n•  Состояние — текущее состояние рассылки;\n•  CID — идентификатор клиента, для которого началась рассылка;\n•  Статус  —  состояние  запуска  рассылки  для  клиента,  см.  ранее  описание  фильтра\n«Состояние запусков рассылки для клиента»;\n•  Попыток — количество попыток начать рассылку;\n•  Последняя попытка — дата последней попытки начать рассылку для клиента.\n•  Аргументы  —  аргументы  события,  переданные  при  генерации.  Для  просмотра  и\nкопирования нужно навести мышью на «глазок».\nРисунок 184 — Пример вывода информации о рассылках в мессенджер, которые начались сразу\nпосле возникновения события\nSMS-рассылка (одна или несколько) началась сразу после возникновения события\nСведения о начавшихся SMS-рассылках практически аналогичны варианту с рассылкой\nв мессенджер. Дополнительно для SMS-рассылок отображаются следующие данные (см.\nРисунок 185):\n•  Телефон — телефон, для которого сгенерировано событие;\n•  Мессенджеры — список messenger_order, как он был указан при вызове события;\n•  Временная зона — значение поля timezone, указанное при вызове события.\n142\nРисунок 185 — Пример вывода информации о SMS-рассылке, которая началась сразу после\nвозникновения события\nЕсли  сообщения  не  приходят,  то  разобраться  в  причине  можно,  изучив  ответ  от  SMS-\nпровайдера. Для этого необходимо нажать на иконку\nв поле «Ошибка» (если ошибка\nимеет место), см. рисунок 186:\nРисунок 186 — Просмотр информации об ошибке при отправке SMS-рассылок\nВызов события отложен до подтверждения номера телефона\nСведения  о  событиях,  отложенных  до  подтверждения  номера  телефона,  практически\nаналогичны  вариантам,  описанным  ранее.  Дополнительно  отображаются  следующие\nданные (см. Рисунок 187):\n143\n•  TTL  —  таймаут  ожидания  подтверждения  номера  телефона,  заданный  при  вызове\nсобытия;\n•  Истечение — дата, когда истекло ожидание.\nРисунок 187 — Пример вывода информации о событии, отложенном до подтверждения номера\nтелефона\nВызов события отложен до подписки на бота в мессенджере\nСведения  о  событиях,  отложенных  до  подписки  на  бота  в  мессенджера,  практически\nаналогичны  вариантам,  описанным  ранее.  Дополнительно  отображаются  следующие\nданные (см. Рисунок 188):\n•  TTL  —  таймаут  ожидания  подписки  на  бота  в  мессенджере,  заданный  при  вызове\nсобытия;\n•  Истечение — дата, когда истекло ожидание подписки.\nРисунок 188 — Пример вывода информации о событии, отложенном до подписки на бота в\nмессенджере\n144\nАудит запусков рассылок\nВ  некоторых  случаях  исследование  проблем  удобнее  проводить  от  рассылки,  а  не  от\nсобытия.  Кроме  того,  не  все  рассылки  начинаются  по  событию,  некоторые  начинаются\nпри выставлении тега или в заданное время. В этом случае удобно использовать вкладку\n«Рассылки».  На  данной  вкладке  можно  выполнить  поиск  информации  о  запусках\nрассылок  по  дате,  а  также  по  их  характеристикам  (для  этого  нужно  нажать  на  иконку\nфильтра, см. Рисунок 189).\nРисунок 189 — Поиск рассылок по их характеристикам\nПеречень  доступных  фильтров  и  их  описание  приведены  в  таблице  11.  Для  поиска\nнеобходимо  задать  хотя  бы  один  из  обязательных  фильтров  –  «Идентификатор»,\n«Название рассылки» или «Дата начала рассылки для клиента».\nТаблица 11 — Описание фильтров для поиска рассылок\nФильтр\nОписание\nИдентификатор\nИдентификатор рассылки.\nСостояние рассылки\nТекущее состояние рассылки.\nИмя клиента\nЧасть или полное имя клиента, для которого началась\nрассылка.\nМессенджер\nМессенджер, через который началась рассылка.\nНомер телефона\nНомер телефона клиента, для которого началась рассылка.\nСостояние запусков\nрассылки для клиента\nСм. аналогичное поле ранее в таблице 10.\n145\nВ  результате  применения  фильтров  отображаются  записи  о  запусках  рассылок,\nудовлетворяющие всем заданным условиям. Есть два режима отображения результатов:\n•  режим карточек (см. Рисунок 190);\n•  режим списка (см. Рисунок 191).\nРежимы  отличаются  только  визуально,  переключение  между  ними  выполняется  при\nпомощи иконки справа от фильтра.\nРисунок 190 — Вывод информации о найденных рассылках (режим карточек)\nРисунок 191 — Вывод информации о найденных рассылках (режим списка)\nИнформационные  поля  аналогичны  тем,  что  описаны  в  подразделе  Аудит  вызовов\nсобытий.\nПри нажатии на ссылку в поле «MID» выполняется переход на страницу с информацией о\nходе выполнения рассылки для клиента.\nПри  нажатии  на  ссылку  в  поле  «Состояние»  выполняется  переход  на  страницу  со\nстатистикой по рассылке (см. подробнее в подразделе",
      "tags": [
        "идентификатор",
        "мессенджер",
        "ошибк",
        "рассылк",
        "редактирован",
        "событ",
        "тег"
      ]
    },
    {
      "section_id": "103_аудит_вызовов_событий",
      "section_title": "Аудит вызовов событий",
      "level": 1,
      "page_start": 136,
      "page_end": 144,
      "text": "Аудит вызовов событий\nНа вкладке «События» можно найти информацию о попытках сгенерировать то или иное\nсобытие. Поиск возможен по дате события, а также по его характеристикам. (для этого\nнужно нажать на иконку фильтра, см. Рисунок 180):\nРисунок 180 — Поиск события по его характеристикам\nПеречень  доступных  фильтров  и  их  описание  приведены  в  таблице  10.  Между  собой\nфильтры применяются по условию «И», т. е. возвращаются результаты, удовлетворяющие\nвсем фильтрам.\n136\nТаблица 10 — Описание фильтров для поиска событий\nФильтр\nДата\nНазвание события\nСписок\nидентификаторов\nрассылок\nСписок\nlaunch_result_ids\nИдентификатор\nбота\nИдентификатор\nклиента\nИмя клиента\nНомер телефона\nТипы запуска\nрассылки по\nсобытию\nОписание\nДата попытки сгенерировать событие. Единственный\nобязательный фильтр для выполнения поиска.\nВ этом фильтре может быть указано полное название события\nили его часть (выполняется поиск заданной подстроки в\nназвании события).\nИдентификаторы рассылок, которые начаты в результате\nвызова события. Фильтр применяется по условию «ИЛИ», т. е.\nвозвращаются результаты, удовлетворяющие хотя бы одному из\nзаданных значений.\nИдентификаторы запусков (launch_customer_ids или\nsms_launch_customer_ids или delayed_trigger_event_id, или\nunsubscribed_trigger_event_id), полученные в результате\nгенерирования событий. Фильтр применяется по условию\n«ИЛИ», т. е. возвращаются результаты, удовлетворяющие хотя\nбы одному из заданных значений.\nВ этом фильтре может быть указано полное системное название\nбота или его часть, т. е. выполняется поиск заданной подстроки.\nИдентификатор клиента, для которого началась рассылка в\nрезультате возникновения события.\nИмя клиента, для которого началась рассылка в результате\nвозникновения события.\nПолный номер телефона клиента или его часть, для которого\nначалась рассылка в результате возникновения события. Т.е.\nвыполняется поиск заданной подстроки\nПозволяет отфильтровать события по «последствиям» запуска.\nМожно задать одно или несколько значений из:\nвызова\n•  «Ожидание  подтверждения  телефона»  –  события,  в\nожидание\nкоторых\nрезультате\nподтверждения клиентом номера телефона (случай, когда\nв\nвозвращается\ndelayed_trigger_event_id).\nрезультате\nначалось\nсобытия\nвызова\n•  «Ожидание подписки на бота в мессенджере» – события, в\nрезультате вызова которых началось ожидание подписки\n(случай,  когда  в\nклиента  на  бота  в  мессенджере\nрезультате\nвозвращается\nсобытия\nunsubscribed_trigger_event_id).\nвызова\n•  «Передано  в  транспорт  мессенджера»  –  события,  в\nрезультате вызова которых началось отправка рассылки в\nмессенджер  (случай,  когда  в  результате  вызова  события\nвозвращается launch_customer_ids).\n137\nФильтр\nОписание\n•  «Передано  в  SMS-провайдер»  –  события,  в  результате\nвызова которых началось отправка SMS-рассылки (через\nSMS-провайдер,  случай,  когда  в  результате  вызова\nсобытия возвращается sms_launch_customer_ids).\nРезультат вызова\nсобытия\nСтатус-код запроса вызова события:\n•  200 — запрос выполнен успешно;\n•  40X – различные виды ошибок.\nСписок возможных\nисточников события\nОдин или несколько источников, откуда сгенерировано\nсобытие:\n•  Рассылка  –  события,  сгенерированные  из  сценария\nв\n«Сгенерировать\n(действие\nсобытие»\nрассылки\nконструкторе рассылок);\n•  Интерфейс  –  события,  сгенерированные  из  консоли\nмаркетолога;\n•  API  –  события,  сгенерированные  путем  вызова  одного  из\nзапросов API;\n•  Системное\nсобытие\nсобытия,\n–\nсгенерированные  ботом  (в  текущей  версии  Maxbot  это\n«Подтверждение номера телефона» и «Добавление нового\nклиента»).\nсистемные\nСостояние запусков\nрассылки для\nклиента\nСтатус запуска рассылки для клиента:\n•  «Готов к отправке» — рассылка готова к началу, но еще не\nначалась;\n•  «Рассылка началась успешно»;\n•  «Ошибка при запуске рассылки»;\n•  «Пропущен, в рассылке нет SMS-блока» — сгенерировано\nсобытие для отправки SMS, но в рассылке нет SMS-блока;\n•  «Пропущен, входит в аудиторию другой рассылки»;\n•  «Клиент отписался от рассылок»;\n•  «Клиент не оплачен»;\n•  «Клиент уже получал рассылку»;\n•  «Рассылка не успела начаться» – рассылка не началась,\nт. к. ее остановили, не успев начать ее для клиента;\n•  «Ошибка при запуске SMS-рассылки»;\n138\nФильтр\nОписание\n•  «Ошибка при вызове внешней системы в SMS-блоке»;\n•  «Ошибка при генерации диплинка для SMS-блока» — при\nотправке  SMS-рассылки  с  лендингом  при  генерации\nдиплинка возникла ошибка;\n•  «Телефон  подтвержден  до  попытки  отправить  SMS»  —\nклиент  подтвердил  номер  телефона  до  отправки  SMS,\nотправка будет осуществлена через мессенджер;\n•  «Ожидает  подписки  клиента  в  мессенджере»  —  начало\nрассылки  отложено  до  подписки  клиентом  на  бота  в\nмессенджере;\n•  «Ожидает  подтверждения  номера  телефона»  —  начало\nрассылки  отложено  до  подтверждения  клиентом  номера\nтелефона.\nВ  результате  применения  фильтров  отображаются  записи  о  попытках  сгенерировать\nсобытия, удовлетворяющие всем заданным условиям.\nЕсть два режима отображения результатов:\n•  режим карточек (см. Рисунок 181);\n•  режим списка (см. Рисунок 182).\nРисунок 181 — Просмотр найденных событий (режим карточек)\n139\nРисунок 182 — Просмотр найденных событий (режим списка)\nРежимы  отличаются  только  визуально,  переключение  между  ними  выполняется  при\nпомощи иконки справа от фильтра.\nПри нажатии на ссылку в поле «ID» можно перейти на страницу с детальной информацией\nо сгенерированном событии. Эта страница разделяется на две части. В верхней части\nстраницы  отображается  общая  информация  о  сгенерированном  событии  (см.  Рисунок\n183):\n•\nID — идентификатор записи о генерации события в журнале аудита событий;\n•  Источник  —  источник,  откуда  пришел  запрос  на  генерацию  события.  См.  «Список\nвозможных источников события» выше;\n•  Рассылка  —  название  рассылки,  если  событие  было  сгенерировано  из  сценария\nрассылки;\n•  Дата — дата генерации события;\n•  Название события из запроса — название события, как оно было указано в запросе;\n•\n•\nID события — идентификатор события в системе;\nID клиента — идентификатор клиента, для которого было сгенерировано событие;\n•  Мессенджер — мессенджер клиента, для которого было сгенерировано событие;\n•  Телефон — телефон клиента, для которого было сгенерировано событие;\n•  Тип — тип запроса на генерацию события. Возможные варианты:\n•  По идентификатору клиента;\n•  По номеру телефона;\n•  Для рассылок с фиксированной аудиторией;\n140\n•  Запрос — тело запроса на генерацию события. Для просмотра и копирования нужно\nнавести мышью на «глазок»;\n•  Статус-код — HTTP status code ответа на запрос генерации события;\n•  Ответ  —  тело  ответа  на  запрос  генерации  события.  Для  просмотра  и  копирования\nнужно навести мышью на «глазок».\nРисунок 183 — Общая информация о сгенерированном событии\nВ  нижней  части  страницы  отображается  информация  о  рассылках,  начавшихся  в\nрезультате  возникновения  события,  либо  информация  о  начавшемся  ожидании\nподтверждения номера телефона или подписки клиента в мессенджере. Информация на\nстранице  с  деталями  события  позволяет  понять,  началась  ли  рассылка  при  вызове\nсобытия,  а  также  ответить  на  вопросы  –  если  рассылка  началась,  то  какая,  и  если  не\nначалась,  то  почему.  Далее  в  подразделах  приведены  примеры  вывода  такой\nинформации.\nРассылка  в  мессенджер  (одна  или  несколько)  началась  сразу  после  возникновения\nсобытия\nСведения о начавшихся рассылках в мессенджере содержат (см. Рисунок 184):\n•\nID — идентификатор записи о генерации события в журнале аудита событий;\n•  Дата — дата генерации события;\n•  MID — идентификатор начавшейся рассылки. При нажатии на ссылку можно перейти\nна  страницу  с  информацией  о  ходе  выполнения  рассылки  для  этого  клиента.\nПодробнее это описано в разделе Просмотр хода выполнения рассылок;\n•  Рассылка — название рассылки, которая началась в результате вызова события. При\nклике по ссылке можно перейти на страницу редактирования рассылки;\n•  Launch  —  идентификатор  запуска  рассылки,  получаемый  при  генерации  события  (в\nполе launch_customer_ids ответа на запрос генерации события);\n141\n•  Запуск, Остановка — даты запуска и остановки рассылки соответственно (в текущей\nверсии Maxbot) не заполняется;\n•  Состояние — текущее состояние рассылки;\n•  CID — идентификатор клиента, для которого началась рассылка;\n•  Статус  —  состояние  запуска  рассылки  для  клиента,  см.  ранее  описание  фильтра\n«Состояние запусков рассылки для клиента»;\n•  Попыток — количество попыток начать рассылку;\n•  Последняя попытка — дата последней попытки начать рассылку для клиента.\n•  Аргументы  —  аргументы  события,  переданные  при  генерации.  Для  просмотра  и\nкопирования нужно навести мышью на «глазок».\nРисунок 184 — Пример вывода информации о рассылках в мессенджер, которые начались сразу\nпосле возникновения события\nSMS-рассылка (одна или несколько) началась сразу после возникновения события\nСведения о начавшихся SMS-рассылках практически аналогичны варианту с рассылкой\nв мессенджер. Дополнительно для SMS-рассылок отображаются следующие данные (см.\nРисунок 185):\n•  Телефон — телефон, для которого сгенерировано событие;\n•  Мессенджеры — список messenger_order, как он был указан при вызове события;\n•  Временная зона — значение поля timezone, указанное при вызове события.\n142\nРисунок 185 — Пример вывода информации о SMS-рассылке, которая началась сразу после\nвозникновения события\nЕсли  сообщения  не  приходят,  то  разобраться  в  причине  можно,  изучив  ответ  от  SMS-\nпровайдера. Для этого необходимо нажать на иконку\nв поле «Ошибка» (если ошибка\nимеет место), см. рисунок 186:\nРисунок 186 — Просмотр информации об ошибке при отправке SMS-рассылок\nВызов события отложен до подтверждения номера телефона\nСведения  о  событиях,  отложенных  до  подтверждения  номера  телефона,  практически\nаналогичны  вариантам,  описанным  ранее.  Дополнительно  отображаются  следующие\nданные (см. Рисунок 187):\n143\n•  TTL  —  таймаут  ожидания  подтверждения  номера  телефона,  заданный  при  вызове\nсобытия;\n•  Истечение — дата, когда истекло ожидание.\nРисунок 187 — Пример вывода информации о событии, отложенном до подтверждения номера\nтелефона\nВызов события отложен до подписки на бота в мессенджере\nСведения  о  событиях,  отложенных  до  подписки  на  бота  в  мессенджера,  практически\nаналогичны  вариантам,  описанным  ранее.  Дополнительно  отображаются  следующие\nданные (см. Рисунок 188):\n•  TTL  —  таймаут  ожидания  подписки  на  бота  в  мессенджере,  заданный  при  вызове\nсобытия;\n•  Истечение — дата, когда истекло ожидание подписки.\nРисунок 188 — Пример вывода информации о событии, отложенном до подписки на бота в\nмессенджере\n144",
      "tags": [
        "идентификатор",
        "мессенджер",
        "ошибк",
        "рассылк",
        "редактирован",
        "событ"
      ]
    },
    {
      "section_id": "104_рассылка_в_мессенджер_одна_или_несколько_началась_сразу_после_возникновения_события",
      "section_title": "Рассылка  в  мессенджер  (одна  или  несколько)  началась  сразу  после возникновения события",
      "level": 2,
      "page_start": 141,
      "page_end": 141,
      "text": "•  Запрос — тело запроса на генерацию события. Для просмотра и копирования нужно\nнавести мышью на «глазок»;\n•  Статус-код — HTTP status code ответа на запрос генерации события;\n•  Ответ  —  тело  ответа  на  запрос  генерации  события.  Для  просмотра  и  копирования\nнужно навести мышью на «глазок».\nРисунок 183 — Общая информация о сгенерированном событии\nВ  нижней  части  страницы  отображается  информация  о  рассылках,  начавшихся  в\nрезультате  возникновения  события,  либо  информация  о  начавшемся  ожидании\nподтверждения номера телефона или подписки клиента в мессенджере. Информация на\nстранице  с  деталями  события  позволяет  понять,  началась  ли  рассылка  при  вызове\nсобытия,  а  также  ответить  на  вопросы  –  если  рассылка  началась,  то  какая,  и  если  не\nначалась,  то  почему.  Далее  в  подразделах  приведены  примеры  вывода  такой\nинформации.\nРассылка  в  мессенджер  (одна  или  несколько)  началась  сразу  после  возникновения\nсобытия\nСведения о начавшихся рассылках в мессенджере содержат (см. Рисунок 184):\n•\nID — идентификатор записи о генерации события в журнале аудита событий;\n•  Дата — дата генерации события;\n•  MID — идентификатор начавшейся рассылки. При нажатии на ссылку можно перейти\nна  страницу  с  информацией  о  ходе  выполнения  рассылки  для  этого  клиента.\nПодробнее это описано в разделе Просмотр хода выполнения рассылок;\n•  Рассылка — название рассылки, которая началась в результате вызова события. При\nклике по ссылке можно перейти на страницу редактирования рассылки;\n•  Launch  —  идентификатор  запуска  рассылки,  получаемый  при  генерации  события  (в\nполе launch_customer_ids ответа на запрос генерации события);\n141\n•  Запуск, Остановка — даты запуска и остановки рассылки соответственно (в текущей\nверсии Maxbot) не заполняется;\n•  Состояние — текущее состояние рассылки;\n•  CID — идентификатор клиента, для которого началась рассылка;\n•  Статус  —  состояние  запуска  рассылки  для  клиента,  см.  ранее  описание  фильтра\n«Состояние запусков рассылки для клиента»;\n•  Попыток — количество попыток начать рассылку;\n•  Последняя попытка — дата последней попытки начать рассылку для клиента.\n•  Аргументы  —  аргументы  события,  переданные  при  генерации.  Для  просмотра  и\nкопирования нужно навести мышью на «глазок».\nРисунок 184 — Пример вывода информации о рассылках в мессенджер, которые начались сразу\nпосле возникновения события",
      "tags": [
        "идентификатор",
        "мессенджер",
        "рассылк",
        "редактирован",
        "событ"
      ]
    },
    {
      "section_id": "6_интерфейс_для_работы_с_рассылками",
      "section_title": "Интерфейс для работы с рассылками",
      "level": 0,
      "page_start": 11,
      "page_end": 15,
      "text": "Интерфейс для работы с рассылками\nВнешний вид интерфейса консоли маркетолога показан на рисунке 7.\nРисунок 7 — Интерфейс консоли управления после авторизации маркетолога\nВ левой части окна находится меню для навигации по разделам консоли маркетолога.\nПосле входа по умолчанию выбран раздел «Рассылки».\nДля  удобства  маркетолога  и  структурирования  созданных  рассылок  предусмотрена\nсистема  каталогов.  Изначально  для  рассылок  задан  только  один  каталог  «Все\nрассылки»,  но  при  помощи кнопки «+ Добавить каталог»  (отображается  внизу  слева  от\nсписка рассылок) можно сформировать требуемую структуру (см. Рисунок 8).\nРисунок 8 — Пример структуры каталогов для рассылок\n11\nНа  мобильной  версии  и  на  десктопах  при  небольшом  размере  окна  браузера  открыть\nкаталоги рассылок можно, нажав на кнопку слева от формы поиска (см. Рисунок 9).\nРисунок 9 — Отображение кнопки для просмотра структуры каталогов рассылок в мобильной\nверсии\nВ правом верхнем углу отображаются данные текущего авторизованного пользователя\n(маркетолога).  При  нажатии  на\nможно  раскрыть  контекстное  меню,  позволяющее\nперейти к настройкам, загрузить документацию, перейти к разделам помощи или выйти\nиз консоли маркетолога (см. Рисунок 10).\nРисунок 10 — Контекстное меню\n, при нажатии на которую\nТакже рядом с именем маркетолога отображается иконка\nможно выполнить переход в другие интерфейсы Maxbot — консоль оператора (Agent) или\nадминистратора (Studio), см. Рисунок 11.\n12\nРисунок 11— Меню для перехода в консоль оператора или администратора\nДля  создания  рассылки  используется  кнопка  «+Создать»,  которая  находится  в  правом\nверхнем углу раздела «Рассылки» (см. Рисунок 12).\nРисунок 12 — Переход к созданию рассылки\nПосле  нажатия  на  кнопку «+  Создать»  необходимо  ввести  название  рассылки,  выбрать\nтип — «информационная» или «целевая» (см. Рисунок 13).\nРисунок 13 — Ввод названия и выбор типа рассылки\nДалее будет открыт интерфейс создания рассылки, включающий (см. Рисунок 14):\n•  3 вкладки, каждая из которых отвечает за соответствующий этап настройки рассылки:\n•  «Конструктор  рассылки»  (открывается  по  умолчанию)  —  вкладка  для  настройки\nсценария рассылки;\n13\n•  «Условия  начала  рассылки»  —  вкладка  для  определения  условий  запуска\nрассылки  и  действующих  ограничений,  см.  подробнее  в  разделе  Настройка\nусловий начала рассылок;\n•  «Целевая  аудитория»  —  вкладка  для  подготовки  данных  для  рассылок  с\nфиксированной аудиторией, см. подробнее в разделе Определение аудитории.\n•  2 вкладки, отражающие результаты запуска рассылки:\n•  «Статистика» — вкладка для просмотра статистики по текущей рассылке;\n•  «Журнал» — вкладка для просмотра статусов отправки рассылки для клиентов, см.\nподробнее в разделе Просмотр журнала рассылок;\n•  Тип рассылки;\n•  Состояние рассылки;\n•  Кнопка для обновления сценария рассылки;\n•  Иконки для управления запуском и остановкой рассылки. Подробнее об управлении\nзапуском  рассылки  (состоянием  рассылки)  см.  в  разделе  Запуск,  перезапуск  и\nостановка рассылок.\nРисунок 14 — Интерфейс настройки рассылки (открыт конструктор рассылки)\nИконка  для\nсписке рассылок (см. Рисунок 15).\nуправления  запуском  и  остановом  рассылок  также  отображается  и  в\n14\nРисунок 15 — Расположение кнопок запуска / остановки в списке рассылок\nМеню, вызываемое при помощи иконки\n, позволяет (см. Рисунок 16):\n•  Посмотреть статистику;\n•  Посмотреть Журнал;\n•  Выгрузить данные;\n•  Сгенерировать событие;\n•  Переместить рассылку в нужный каталог;\n•  Клонировать (дублировать) рассылку;\n•  Удалить рассылку.\nРисунок 16 — Расположение кнопок меню в списке рассылок\nКолонка  с  названием  «Тип»  визуализирует  тип  указанной  рассылки  (см.  Рисунок  15).\nИнформационные рассылки обозначаются иконкой\n, а целевые –\n.\n15\nРисунок 17 — Расположение кнопок запуска / остановки в списке рассылок\n.\nРядом со строкой поиска рассылки по названию справа размещена иконка фильтра\nПри  ее  нажатии  можно  отфильтровать  рассылки  в  каталоге  по  типу  рассылки\n(информационная  и  целевая)  и  по  состоянию  рассылки  (не  запускалась,  включена  в\nактивном режиме, в пассивном и выключена) см. Рисунок 18.\nРисунок 18 - Фильтры, применяемые в каталоге рассылок",
      "tags": [
        "интерфейс",
        "настройк",
        "рассылк",
        "событ",
        "тип"
      ]
    }
  ]
}